# UI元素定位工具

一个强大的Windows UI元素定位和自动化测试工具，支持UIAutomation和Pywinauto两种定位模式。

## 功能特点

- **多种捕获模式**
  - F4快捷键：定点捕获当前鼠标位置的UI元素
  - F5快捷键：开启/关闭鼠标左键点击捕获模式
  - F6快捷键：开启/关闭实时捕获模式

- **丰富的元素信息**
  - 元素基本属性（名称、类名、控件类型等）
  - 元素位置信息
  - 自动化ID和运行时ID
  - 元素深度和XPath路径

- **智能代码生成**
  - 自动生成UIAutomation定位代码
  - 生成包含父窗口的完整定位链
  - 提供简化版定位代码
  - 支持Pywinauto定位代码生成

- **实时测试功能**
  - 支持多行代码测试
  - 显示执行时间统计
  - 支持UIAutomation和Pywinauto两种模式

## 安装步骤

1. 克隆项目到本地
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```
3. 以管理员权限运行：
   - 双击 `run_as_admin.bat`
   或
   - 直接运行 `ui_locator_gui.py`

## 使用说明

### 基本操作

1. **定点捕获（F4）**
   - 将鼠标移动到目标元素位置
   - 按下F4键
   - 保持鼠标静止等待5秒
   - 系统会自动完成元素分析

2. **左键点击捕获（F5）**
   - 按F5开启点击捕获模式
   - 点击目标元素进行捕获
   - 再次按F5关闭该模式

3. **实时捕获（F6）**
   - 按F6开启实时捕获
   - 移动鼠标查看元素信息
   - 再次按F6关闭该模式

### 实时测试

1. 点击界面上的"实时测试"按钮
2. 选择定位模式（UIAutomation/Pywinauto）
3. 添加测试代码
4. 点击"运行测试"执行代码
5. 查看执行时间和结果

## 注意事项

- 使用F4捕获时，请保持鼠标位置不要移动
- 某些应用可能需要管理员权限才能正确定位元素
- 建议在测试环境中先进行验证
- 注意处理元素不存在的异常情况

## 开发者信息

- 开发者：新一
- 版本：v0.0.0.1

## 许可证

MIT License